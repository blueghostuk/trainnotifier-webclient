@{
    Layout = "~/_Layout.cshtml";
}
@using System.Web.Optimization;
@section CustomCss{
    @Styles.Render("~/bundles/css/search-schedule")
}
@section FooterJs{
    @Scripts.Render("~/bundles/js/search-schedule")
}
@section TopMenu{
    <li><a href="~/">Home</a></li>
    <li class="active"><a>Search Schedule</a></li>
    <li><a href="~/train">Train</a></li>
    <li><a href="~/ppm">PPM</a></li>
    <li><a href="~/live">Live Feed</a></li>
}
<div class="row-fluid">
    <div class="span2 phone-hide">
        <div class="well sidebar-nav">
            <ul class="nav nav-list" id="commandOptions">
                <li class="nav-header">By CRS Code:</li>
                <li id="from-crs"><a href="#from/" onclick="thisPage.setCommand('from/');"><strong>Trains Stating From:</strong><br />
                    &nbsp;&nbsp;from/[CRS]</a></li>
                <li id="at-crs"><a href="#at/" onclick="thisPage.setCommand('at/');"><strong>Trains Calling At:</strong><br />
                    &nbsp;&nbsp;at/[CRS]</a></li>
                <li id="to-crs"><a href="#to/" onclick="thisPage.setCommand('to/');"><strong>Trains Terminating At:</strong><br />
                    &nbsp;&nbsp;to/[CRS]</a></li>
                <li id="from-to-crs"><a href="#from/" onclick="thisPage.setCommand('from/');"><strong>Trains going from [A] to [B]:</strong><br />
                    &nbsp;&nbsp;from/[CRS-A]/to/[CRS-B]</a></li>
                <li class="nav-header">By Stanox Code:</li>
                <li id="from"><a href="#from/" onclick="thisPage.setCommand('from/');"><strong>Trains Stating From:</strong><br />
                    &nbsp;&nbsp;from/[stanox]</a></li>
                <li id="at"><a href="#at/" onclick="thisPage.setCommand('at/');"><strong>Trains Calling At:</strong><br />
                    &nbsp;&nbsp;at/[stanox]</a></li>
                <li id="to"><a href="#to:" onclick="thisPage.setCommand('to/');"><strong>Trains Terminating At:</strong><br />
                    &nbsp;&nbsp;to/[stanox]</a></li>
                <li id="from-to"><a href="#from/" onclick="thisPage.setCommand('from');"><strong>Trains going from [A] to [B]:</strong><br />
                    &nbsp;&nbsp;from/[stanox-A]/to/[stanox-B]</a></li>
            </ul>
        </div>
        <div class="well sidebar-nav" id="stationDetails">
            <ul class="nav nav-list">
                <li class="nav-header" data-bind="text: toDisplay()">Station Details</li>
                <li><strong>CRS:</strong><span data-bind="text: locationCRS"></span></li>
                <li><a data-bind="attr: { href: 'search/from/' + locationStanox(), onclick: 'setHash(\'from/' + locationStanox() + '\');' }" title="View Trains Starting from this station">Trains Starting From</a></li>
                <li><a data-bind="attr: { href: 'search/at/' + locationStanox(), onclick: 'setHash(\'at/' + locationStanox() + '\');' }" title="View Trains Calling at this station">Trains Calling At</a></li>
                <li><a data-bind="attr: { href: 'search/to/' + locationStanox(), onclick: 'setHash(\'to/' + locationStanox() + '\');' }" title="View Trains Terminating at this station">Trains Terminating At</a></li>
            </ul>
        </div>
        <div class="well sidebar-nav">
            <p class="centerText" style="padding: 2px;">
                At the moment this only shows trains that have been Activated.<br />
                <br />
                Empty rows are activations not matched to a schedule.<br />
                <br />
                Use
                <br />
                <i>/YYYY-MM-DD/HH-mm/HH-mm</i>
                <br />
                at the end of a command to specify a start date/time and end time manually
            </p>
        </div>
    </div>
    <!--/span2-->
    <div class="span10">
        <div class="row alert alert-info hide" id="no-results-row">
            <strong>No Results Found</strong>
        </div>
        <div class="row alert alert-error hide" id="error-row">
            <strong>Error fetching data. Please Refresh to try again</strong>
        </div>
        <div class="progress progress-striped active hide">
            <div class="bar" style="width: 100%"></div>
        </div>
        <div class="row pagination" id="title" data-bind="visible: From">
            <span data-bind="text: From" class="stationName xl"></span><span data-bind="visible: To">&nbsp;to&nbsp;</span>
            <span data-bind="text: To" class="stationName xl"></span>
            <br />
            <span data-bind="text: DateRange"></span>
            <hr style="margin: 5px 0px;" />
        </div>
        <div class="row">
            <ul class="pager">
                <li><a href="#" onclick="previousDate(); return false;" class="neg-hrs">&lt; Earlier</a></li>
                <li><a href="#" onclick="nextDate(); return false;" class="plus-hrs">Later &gt;</a></li>
            </ul>
            <table class="table table-hover table-bordered table-header-colour" id="origin-search-results" data-bind="visible: Trains().length > 0">
                <thead class="header">
                    <tr>
                        <th colspan="2"></th>
                        <th colspan="2">From</th>
                        <th class="phone-hide" colspan="3">Departure</th>
                        <th class="phone-show" colspan="2">Departure</th>
                        <th colspan="2">To</th>
                        <th class="phone-hide" colspan="3">Arrival</th>
                        <th class="phone-show" colspan="2">Arrival</th>
                    </tr>
                    <tr>
                        <th class="phone-hide">Train ID</th>
                        <th class="phone-show">ID</th>
                        <th class="phone-hide">Operator</th>
                        <th class="phone-show">Op</th>
                        <th>Station</th>
                        <th class="phone-hide">Platform</th>
                        <th class="phone-show">P</th>
                        <th class="phone-hide">Public</th>
                        <th class="phone-show">Ex</th>
                        <th class="phone-hide">WTT</th>
                        <th class="phone-hide">Actual</th>
                        <th class="phone-show">Act</th>
                        <th>Station</th>
                        <th class="phone-hide">Platform</th>
                        <th class="phone-show">P</th>
                        <th class="phone-hide">Public</th>
                        <th class="phone-show">Ex</th>
                        <th class="phone-hide">WTT</th>
                        <th class="phone-hide">Actual</th>
                        <th class="phone-show">Act</th>
                    </tr>
                </thead>
                <tbody data-bind="foreach: Trains">
                    <tr data-bind="css: { error: Cancellation, info: ChangeOfOrigin, reinstatement: Reinstatement }, attr: { title: Tooltip }">
                        <td><a data-bind="text: HeadCode, attr: { href: 'trains/' + TrainUid() + '/' + SchedOriginDeparture() }"></a></td>
                        <td data-bind="text: AtocCode.Code, attr: { title: AtocCode.Name }"></td>
                        <td class="stationName">
                            <span data-bind="text: Origin.Description, css: { changeOfOrigin: ChangeOfOrigin }"></span>
                            <!-- ko if: ChangeOfOrigin -->
                            <br />
                            <span data-bind="text: ChangeOfOrigin.NewOrigin.Description().toLowerCase()"></span>
                            <!-- /ko -->
                        </td>
                        <td data-bind="text: Origin.Platform"></td>
                        <td class="time" title="Public Departure" data-bind="text: Origin.PublicDeparture"></td>
                        <td class="phone-hide" title="WTT Departure" data-bind="text: Origin.Departure"></td>
                        <td class="time" title="Actual Departure" data-bind="text: ActualDeparture"></td>
                        <td class="stationName">
                            <span data-bind="text: Destination.Description, css: { changeOfDestination: Cancellation && Cancellation.Type && Cancellation.Type() == 'EN ROUTE' }"></span>
                            <!-- ko if: Cancellation && Cancellation.Type && Cancellation.Type() == 'EN ROUTE' -->
                            <br />
                            <span data-bind="text: Cancellation.CancelledAt.Description().toLowerCase()"></span>
                            <!-- /ko -->
                        </td>
                        <td data-bind="text: Destination.Platform"></td>
                        <td class="time" title="Public Arrival" data-bind="text: Destination.PublicArrival"></td>
                        <td class="phone-hide" title="WTT Arrival" data-bind="text: Destination.Arrival"></td>
                        <td class="time" title="Actual Arrival" data-bind="text: ActualArrival"></td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-hover table-bordered table-header-colour" id="callingAt-search-results" data-bind="visible: Trains().length > 0">
                <thead class="header">
                    <tr>
                        <th colspan="2"></th>
                        <th>From</th>
                        <th></th>
                        <th class="phone-hide" colspan="3">Arrival</th>
                        <th class="phone-show" colspan="2">Arrival</th>
                        <th class="phone-hide" colspan="3">Departure</th>
                        <th class="phone-show" colspan="2">Departure</th>
                        <th>To</th>
                        <th class="phone-hide" colspan="3">Arrival</th>
                        <th class="phone-show" colspan="2">Arrival</th>
                    </tr>
                    <tr>
                        <th class="phone-hide">Train ID</th>
                        <th class="phone-show">ID</th>
                        <th class="phone-hide">Operator</th>
                        <th class="phone-show">Op</th>
                        <th>Station</th>
                        <th class="phone-hide">Platform</th>
                        <th class="phone-show">P</th>
                        <th class="phone-hide">Expected</th>
                        <th class="phone-show">Ex</th>
                        <th class="phone-hide">WTT</th>
                        <th class="phone-hide">Actual</th>
                        <th class="phone-show">Act</th>
                        <th class="phone-hide">Expected</th>
                        <th class="phone-show">Ex</th>
                        <th class="phone-hide">WTT</th>
                        <th class="phone-hide">Actual</th>
                        <th class="phone-show">Act</th>
                        <th>Station</th>
                        <th class="phone-hide">Expected</th>
                        <th class="phone-show">Ex</th>
                        <th class="phone-hide">Actual</th>
                        <th class="phone-show">Act</th>
                    </tr>
                </thead>
                <tbody data-bind="foreach: Trains">
                    <tr data-bind="css: { pass: Pass, cancel: Cancellation, info: ChangeOfOrigin, reinstatement: Reinstatement }, attr: { title: Tooltip }">
                        <td><a data-bind="text: HeadCode, attr: { href: 'trains/' + TrainUid() + '/' + SchedOriginDeparture() }"></a></td>
                        <td data-bind="text: AtocCode.Code, attr: { title: AtocCode.Name }"></td>
                        <td class="stationName">
                            <span data-bind="text: Origin.Description, css: { changeOfOrigin: ChangeOfOrigin }"></span>
                            <!-- ko if: ChangeOfOrigin -->
                            <br />
                            <span data-bind="text: ChangeOfOrigin.NewOrigin.Description().toLowerCase()"></span>
                            <!-- /ko -->
                        </td>
                        <td data-bind="text: Origin.Platform"></td>
                        <td title="Expected Arrival" data-bind="text: Origin.PublicArrival, visible: !Pass()"></td>
                        <td class="phone-hide" title="WTT Arrival" data-bind="text: Pass() ? 'Pass' : Origin.Arrival, attr: { colspan: Pass() ? 2 : 0 }"></td>
                        <td class="phone-show" colspan="2" data-bind="visible: Pass()">Pass</td>
                        <td title="Actual Arrival" data-bind="text: ActualArrival"></td>
                        <td title="Expected Departure" data-bind="text: Destination.PublicDeparture, visible: !Pass()"></td>
                        <td class="phone-hide" title="WTT Departure" data-bind="text: Pass() ? Pass : Destination.Departure, attr: { colspan: Pass() ? 2 : 0 }"></td>
                        <td class="phone-show" data-bind="text: Pass, visible: Pass()"></td>
                        <td class="phone-hide" title="Actual Departure" data-bind="text: ActualDeparture"></td>
                        <td class="phone-show" title="Actual Departure" data-bind="text: ActualDeparture, visible: !Pass()"></td>
                        <td class="stationName">
                            <span data-bind="text: Destination.Description, css: { changeOfDestination: Cancellation && Cancellation.Type && Cancellation.Type() == 'EN ROUTE' }"></span>
                            <!-- ko if: Cancellation && Cancellation.Type && Cancellation.Type() == 'EN ROUTE' -->
                            <br />
                            <span data-bind="text: Cancellation.CancelledAt.Description().toLowerCase()"></span>
                            <!-- /ko -->
                        </td>
                        <td title="Expected Arrival" data-bind="text: ExpectedDestinationArrival"></td>
                        <td title="Actual Arrival" data-bind="text: ActualDestinationArrival"></td>
                    </tr>
                </tbody>
            </table>
            <ul class="pager">
                <li><a href="#" onclick="previousDate(); return false;" class="neg-hrs">&lt; Earlier</a></li>
                <li><a href="#" onclick="nextDate(); return false;" class="plus-hrs">Later &gt;</a></li>
            </ul>
        </div>
    </div>
    <!--/span10-->
</div>
<!--/row-fluid-->
