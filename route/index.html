@{
    Layout = "~/_Layout.cshtml";
}
@using System.Web.Optimization;
@section CustomCss{
    @Styles.Render("~/bundles/css/route")
}
@section FooterJs{
    @Scripts.Render("~/bundles/js/route")
}
@section TopMenu{
    <li><a href="~/">Home</a></li>
    <li><a class="active">Routes</a></li>
    <li><a href="http://www.whattrain.co.uk/" target="_blank">Stations</a></li>
    <li><a href="~/ppm">PPM</a></li>
    <li><a href="~/about">About</a></li>
}
<div class="row">
    <div class="col-md-4 col-xs-12">
        Select Route:
        <select class="form-control" id="route-selector">
            <option data-routeid="xcs" value="xcs">XCity South</option>
            <option data-routeid="xcn" value="xcn">XCity North</option>
            <option data-routeid="wvh" value="wvh">WVH-BHM</option>
        </select>
    </div>
</div>
<div class="row">
    <div class="col-md-4 col-xs-12">
        <table id="route">
            <thead>
                <tr>
                    <td colspan="2"><span class="glyphicon glyphicon-arrow-down"></span></td>
                    <td colspan="2"><span class="glyphicon glyphicon-arrow-up"></span></td>
                </tr>
            </thead>
            <tbody data-bind="foreach: $data">
                <tr>
                    <td class="comment down label" data-bind="css: { 'label-primary': down.label, 'label-info': !down.label }">
                        <abbr data-bind="text: down.text, attr: { title: down.abbr }"></abbr>
                    </td>
                    <td class="berth down" data-bind="text: down.contents, attr: { title: down.timestamp }, click: function () { showTrain(down); }"></td>
                    <td class="berth up" data-bind="text: up.contents, attr: { title: up.timestamp }, click: function () { showTrain(up); }"></td>
                    <td class="comment up label" data-bind="css: { 'label-primary': down.label, 'label-info': !down.label }">
                        <abbr data-bind="text: up.text, attr: { title: up.abbr }"></abbr>
                    </td>
                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="2"><span class="glyphicon glyphicon-arrow-down"></span></td>
                    <td colspan="2"><span class="glyphicon glyphicon-arrow-up"></span></td>
                </tr>
            </tfoot>
        </table>
    </div>
    <!--/span3-->
    <div class="col-md-8 col-xs-6">
        <div class="row alert alert-info hide" id="no-results-row">
            <strong>No Results Found</strong>
        </div>
        <div class="row alert alert-error hide" id="error-row">
            <strong>Error fetching data. Please Refresh to try again</strong>
        </div>
        <div class="progress progress-striped active hide">
            <div class="bar" style="width: 100%"></div>
        </div>
        <table class="table table-hover table-bordered table-header-colour" id="route-results" data-bind="visible: results().length > 0">
            <thead class="header">
                <tr>
                    <th>ID</th>
                    <th>TOC</th>
                    <th>From</th>
                    <th>At</th>
                    <th>To</th>
                    <th>At</th>
                </tr>
            </thead>
            <tbody data-bind="foreach: results">
                <tr data-bind="css: { info: highlight }">
                    <td><a data-bind="text: headCode, attr: { href: 'trains/' + trainId + '/' + departureDate }"></a></td>
                    <td data-bind="text: operatorCode, attr: { title: operatorName }"></td>
                    <td class="stationName" data-bind="css: fromStationCss">
                        <span data-bind="text: fromStation, css: { changeOfOrigin: changeOfOriginStation }"></span>
                        <span data-bind="text: changeOfOriginStation"></span>
                    </td>
                    <td data-bind="text: departure"></td>
                    <td class="stationName" data-bind="css: toStationCss">
                        <span data-bind="text: toStation, css: { changeOfDestination: cancelEnRoute }"></span>
                        <span data-bind="text: cancelEnRoute"></span>
                    </td>
                    <td data-bind="text: arrival"></td>
                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="6" class="text-warning text-center">
                        The highlighted train movement (if any) is not entirely accurate yet. You can probably tell which one is correct more accurately
                    </td>
                </tr>
            </tfoot>
        </table>
    </div>
    <!--/span9-->
</div>
<!--/row-fluid-->
<div class="row">
    <p class="text-warning info-text">
        <i class="glyphicon glyphicon-info-sign"></i>&nbsp;The above boxes are just my guestimation based on running trains. I plan to map this better at some point.<br />
        Click on a train to view matched headcodes<br />
        <i class="glyphicon glyphicon-info-sign"></i>&nbsp;Data is updated every 5 seconds
    </p>
</div>
